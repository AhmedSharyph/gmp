<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Child Nutrition & Growth Monitoring Assessment Tool</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
</head>
<body class="bg-gray-100 p-6">

<div class="max-w-5xl mx-auto bg-white p-6 rounded-lg shadow-lg">
  <h1 class="text-2xl font-bold mb-4">üßí Child Nutrition & Growth Monitoring Assessment Tool</h1>

  <form id="dataForm" class="space-y-6">

    <!-- A. Facility Information -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">üìç Facility Information</h2>

      <!-- Health Facility Dropdown -->
      <div>
        <label for="healthFacility" class="block font-medium mb-1">1. Name of health facility:</label>
        <select id="healthFacility" name="healthFacility" required class="w-full border rounded p-2"></select>
      </div>

      <!-- Who conducts GMP -->
      <div>
        <p class="font-medium mt-4">2. Who conducts GMP?</p>
        <label class="block mt-2">a. Staff Name</label>
        <input type="text" name="staffName" class="w-full border rounded p-2" required>

        <label class="block mt-2">b. Title</label>
        <input type="text" name="staffTitle" class="w-full border rounded p-2" required>

        <label class="block mt-2">c. Contact</label>
        <input type="text" name="staffContact" class="w-full border rounded p-2" required>

        <label class="block mt-2">d. Training in IYCF or GMP:</label>
        <select name="training" class="w-full border rounded p-2" required>
          <option value="" disabled selected>Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>
      </div>

      <!-- Children Counts -->
      <div class="mt-4">
        <label class="block mt-2">3. How many children under five?</label>
        <input type="number" name="childrenUnder5" class="w-full border rounded p-2" required>

        <label class="block mt-2">4. How many children under 2?</label>
        <input type="number" name="childrenUnder2" class="w-full border rounded p-2" required>

        <label class="block mt-2">5. How many children under 2 years attending regular GMP?</label>
        <input type="number" name="childrenUnder2GMP" class="w-full border rounded p-2" required>
      </div>
    </section>

    <!-- 2. Child Nutrition Prevalence Data -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">üìä Child Nutrition Prevalence Data</h2>

      <label class="block mt-2">2.1 How many children under 5 attending regular GMP?</label>
      <input type="number" name="under5GMP" class="w-full border rounded p-2" required>

      <p class="font-medium mt-4">2.2 Among children under 5 screened in one month:</p>
      <div class="grid grid-cols-2 gap-4 mt-2">
        <label>Underweight<input type="number" name="underweight5" class="border rounded p-2 w-full"></label>
        <label>Stunted<input type="number" name="stunted5" class="border rounded p-2 w-full"></label>
        <label>Wasted<input type="number" name="wasted5" class="border rounded p-2 w-full"></label>
        <label>Overweight<input type="number" name="overweight5" class="border rounded p-2 w-full"></label>
        <label>Obesity<input type="number" name="obesity5" class="border rounded p-2 w-full"></label>
      </div>

      <label class="block mt-2">2.3 How many children under 2 attending GMP/screened regularly?</label>
      <input type="number" name="under2Screened" class="w-full border rounded p-2" required>

      <p class="font-medium mt-4">Among children under 2, how many were:</p>
      <div class="grid grid-cols-2 gap-4 mt-2">
        <label>Underweight<input type="number" name="underweight2" class="border rounded p-2 w-full"></label>
        <label>Stunted<input type="number" name="stunted2" class="border rounded p-2 w-full"></label>
        <label>Wasted<input type="number" name="wasted2" class="border rounded p-2 w-full"></label>
        <label>Overweight<input type="number" name="overweight2" class="border rounded p-2 w-full"></label>
        <label>Obesity<input type="number" name="obesity2" class="border rounded p-2 w-full"></label>
      </div>
    </section>

    <!-- 3. Growth Monitoring Practices -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">üìè Growth Monitoring Practices</h2>

      <label>3.1 Is growth monitoring routinely conducted?</label>
      <select name="growthMonitoring" class="w-full border rounded p-2" required onchange="toggleSection('nutritionTopics', this.value)">
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>3.2 Is the developmental tracking done on the book?</label>
      <select name="trackingBook" class="w-full border rounded p-2" required>
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>3.3 Does the facility enter Child development tracking to DHIS-II module?</label>
      <select name="trackingDHIS" class="w-full border rounded p-2" required>
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>3.4 Is nutrition counseling or IYCF provided during visits?</label>
      <select name="nutritionCounseling" class="w-full border rounded p-2" required onchange="toggleSection('nutritionTopics', this.value)">
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <!-- Nutrition Topics -->
      <div id="nutritionTopics" class="hidden mt-2 space-y-2 border p-2 rounded">
        <p>3.4 If yes, what are the topics:</p>
        <label><input type="checkbox" name="topics" value="Exclusive Breastfeeding"> Exclusive Breastfeeding</label>
        <label><input type="checkbox" name="topics" value="Complimentary Feeding"> Complimentary Feeding</label>
        <label><input type="checkbox" name="topics" value="Responsive Feeding"> Responsive Feeding</label>
        <label><input type="checkbox" name="topics" value="Feeding during illness"> Feeding during illness</label>
        <label><input type="checkbox" name="topics" value="Fussy eating/not eating"> Fussy eating/not eating</label>
        <label><input type="checkbox" name="topics" value="Feeding when growth is faltering"> Feeding when growth is faltering</label>
        <label><input type="checkbox" name="topics" value="Feeding practices for children who are overweight"> Feeding practices for children who are overweight</label>
      </div>

      <label>3.5 Any child identified with delays this year?</label>
      <select name="childDelays" class="w-full border rounded p-2" required onchange="toggleSection('delaysAdvice', this.value)">
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <div id="delaysAdvice" class="hidden mt-2">
        <label>If so, what do you, health worker say or tell the parent?</label>
        <textarea name="delaysAdviceText" class="w-full border rounded p-2"></textarea>
      </div>

      <label>3.6 Are growth charts properly filled and interpreted?</label>
      <select name="growthCharts" class="w-full border rounded p-2" required>
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>3.7 Was any group session held for parents this year?</label>
      <select name="groupSession" class="w-full border rounded p-2" required onchange="toggleSection('sessionCount', this.value)">
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <div id="sessionCount" class="hidden mt-2">
        <label>How many sessions?</label>
        <input type="number" name="sessionCountNumber" class="w-full border rounded p-2">
      </div>

    </section>

    <!-- 4. Other public health programs and events -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">üõ†Ô∏è Other ‚Äì Public Health Programs and Events</h2>

      <label>4.1 Key issues affecting adolescents and young people‚Äôs health:</label>
      <div class="grid grid-cols-2 gap-2 mt-1">
        <label><input type="checkbox" name="issues" value="Unhealthy diet"> Unhealthy diet</label>
        <label><input type="checkbox" name="issues" value="Skipping meals"> Skipping meals</label>
        <label><input type="checkbox" name="issues" value="Soft drinks & energy drinks"> Soft drinks & energy drinks</label>
        <label><input type="checkbox" name="issues" value="Mental health problems"> Mental health problems</label>
        <label><input type="checkbox" name="issues" value="Mental health illness"> Mental health illness</label>
        <label><input type="checkbox" name="issues" value="Diabetes"> Diabetes</label>
        <label><input type="checkbox" name="issues" value="Cancer"> Cancer</label>
        <label><input type="checkbox" name="issues" value="Other NCDs"> Other NCDs</label>
        <label><input type="checkbox" name="issues" value="Not active"> Not active</label>
        <label><input type="checkbox" name="issues" value="Smoking & vaping"> Smoking & vaping</label>
        <label><input type="checkbox" name="issues" value="Drugs"> Drugs</label>
        <label><input type="checkbox" name="issues" value="Unwanted pregnancies"> Unwanted pregnancies</label>
        <label><input type="checkbox" name="issues" value="Disabilities"> Disabilities</label>
        <label><input type="checkbox" name="issues" value="High Screen time"> High Screen time</label>
      </div>

      <label class="block mt-2">4.2 What prevention activities do you conduct?</label>
      <textarea name="preventionActivities" class="w-full border rounded p-2"></textarea>

      <label class="block mt-2">4.3 Do you conduct health promotion, community engagement or outreach activities?</label>
      <select name="healthPromotion" class="w-full border rounded p-2" required>
        <option value="" disabled selected>Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label class="block mt-2">4.4 How many were conducted this year?</label>
      <input type="number" name="activitiesCount" class="w-full border rounded p-2">

            <label class="block mt-2">Remarks from Assessor</label>
      <input type="textaria" name="assessor_remarks" class="w-full border rounded p-2">
    </section>


        <!-- 3. Growth Monitoring Practices -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">EXTRA - Immunization</h2>

      <label class="block mt-2">Children with zero dose (no vaccinated)</label>
      <input type="number" name="zerovaccination" class="w-full border rounded p-2">

 <label class="block mt-2">Reasons for Not Vaccinating?</label>
      <select name="noVaccination" class="w-full border rounded p-2" required>
        <option value="" disabled selected>Select</option>
        <option value="Refusal">Refusal</option>
        <option value="Delay">Delay</option>
                <option value="Hesitancy">Hesitancy</option>
                        <option value="Medical">Medical</option>

      </select>
      <label class="block mt-2">Other Resons</label>
      <input type="textarea" name="aother_zrodose_reasons" class="w-full border rounded p-2">
  </section>

            <!-- 3. Growth Monitoring Practices -->
    <section class="border-b pb-4">
      <h2 class="text-xl font-semibold mb-2">Asseror Remarks</h2>
       <label class="block mt-2">Remarks from Assessor</label>
      <input type="textarea" name="assessor_remarks" class="w-full border rounded p-2">
    </section>

    
    <!-- Submit Button -->
    <div class="text-center mt-4">
      <button id="submitBtn" type="submit" class="bg-blue-600 text-white font-bold px-6 py-2 rounded hover:bg-blue-700">
        Submit Data
      </button>
    </div>
  </form>
</div>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyUlbwuQHD5tkCef0ModjzMjNmEJQYJFqlNXVNu9q-kzYE09Iad8qcfbVq57R-pYmHH/exec';
let healthFacilityChoices;

// Load health facility dropdown options
async function fetchOptions() {
  const select = document.getElementById('healthFacility');
  try {
    const response = await fetch(`${WEB_APP_URL}?method=getOptions`);
    const options = await response.json();
    select.innerHTML = '';
    
    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.textContent = 'Select a facility...';
    defaultOption.disabled = true;
    defaultOption.selected = true;
    select.appendChild(defaultOption);

    options.forEach(option => {
      const opt = document.createElement('option');
      opt.value = option;
      opt.textContent = option;
      select.appendChild(opt);
    });

    if (healthFacilityChoices) healthFacilityChoices.destroy();
    healthFacilityChoices = new Choices(select, { searchEnabled: true, shouldSort: false, itemSelectText: '' });

  } catch (err) {
    select.innerHTML = '<option value="">Error loading facilities</option>';
    console.error(err);
  }
}

// Toggle sections based on selection
function toggleSection(sectionId, value) {
  const section = document.getElementById(sectionId);
  section.classList.toggle('hidden', value !== 'Yes');
}

// Form submission
document.getElementById('dataForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const params = new URLSearchParams(formData);

  const submitBtn = document.getElementById('submitBtn');
  submitBtn.disabled = true;
  submitBtn.textContent = 'Submitting...';

  try {
    const res = await fetch(WEB_APP_URL, { method: 'POST', body: params });
    const result = await res.json();
    alert(result.status === 'success' ? 'Form submitted successfully!' : 'Submission failed: ' + result.message);
    this.reset();
    healthFacilityChoices.clearStore();
  } catch (err) {
    alert('Submission failed: ' + err.message);
  } finally {
    submitBtn.disabled = false;
    submitBtn.textContent = 'Submit Data';
  }
});

// Initialize
window.onload = fetchOptions;
</script>
</body>
</html>
